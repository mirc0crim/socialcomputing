<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
		<title>Recorder Example</title>
		<link rel="stylesheet" type="text/css" href="/stylesheet.css" />
	</head>
	<body>
		<script type="text/javascript" src="recorder.js"></script>
		<script>
			function timecode(ms) {
				var hms = {
					h : Math.floor(ms / (60 * 60 * 1000)),
					m : Math.floor((ms / 60000) % 60),
					s : Math.floor((ms / 1000) % 60)
				};
				var tc = [];
				// Timecode array to be joined with '.'

				if (hms.h > 0) {
					tc.push(hms.h);
				}

				tc.push((hms.m < 10 && hms.h > 0 ? "0" + hms.m : hms.m));
				tc.push((hms.s < 10 ? "0" + hms.s : hms.s));

				return tc.join(':');
			}


			Recorder.initialize({
				swfSrc : "recorder.swf"
			});

			function record() {
				Recorder.record({
					start : function() {
						//alert("recording starts now. press stop when youre done. and then play or upload if you want.");
					},
					progress : function(milliseconds) {
						document.getElementById("recording").style.visibility = 'visible';
						document.getElementById("time").innerHTML = timecode(milliseconds);
					}
				});
			}

			function play() {
				Recorder.stop();
				Recorder.play({
					progress : function(milliseconds) {
						document.getElementById("time").innerHTML = timecode(milliseconds);
					}
				});
			}

			function stop() {
				document.getElementById("recording").style.visibility = 'hidden';
				Recorder.stop();
			}

			function upload(filename) {
				document.getElementById("uploading").style.visibility = 'visible';
				Recorder.upload({
					method : "POST",
					url : "http://mirc0crim.bugs3.com/recording/recorder_server.php",
					audioParam : "audio",
					params : {
						"name" : filename
					},
					success : function() {
						alert("Your file was uploaded!");
						document.getElementById("uploading").style.visibility = 'hidden';
					}
				});
			}
		</script>

		
		<?php 
			$pageName = "Project Social Computing - Record";
			include('../header.php'); 
		?>
		<div class="left">
			<h4>Quick Links</h4>
			<a href="/TestAccent.html"><p>Test your Accent</p></a>
			<a href="/Rate.html"><p>Rate Recordings</p></a>
			<a href="/Lessons.html"><p>Lessons</p></a>
		</div>
		<div class="right" style="height:450px;">
			<div id="wrapper">
			<h1><a href="https://github.com/jwagener/recorder.js">Recorder Example</a></h1>
			<p>
				This is a very basic example for the Recorder.js.
				Checkout <a href="https://github.com/jwagener/recorder.js">GitHub</a> for details and have a look at the source for this file.
				Start by clicking record:
			</p>
			<div style="text-align:center;">				
				<a href="javascript:record()" id="record" ><img src="../img/Record.gif"/></a>
				<a href="javascript:play()" id="play" ><img src="../img/Play.gif"/></a>
				<a href="javascript:stop()" id="stop" ><img src="../img/Stop.gif"/></a>
				<a href="javascript:upload('audio')" id="upload" ><img src="../img/Submit.gif"/></a>
			</div>

			<div id="recording" style="visibility: hidden; text-align:center;">Recording ... </div>
			<div id="uploading" style="visibility: hidden; text-align:center;">Uploading ... </div>
			<div id="time" style="text-align:center;">0:00</div>
		</div>
		</div>
		<?php include('../footer.php') ?>
	</body>
</html>
